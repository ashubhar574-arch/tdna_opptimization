# Databricks notebook source
json_schema=StructType([StructField('LiveFeed', StructType([StructField('context', StructType([StructField('activities', ArrayType(StructType([StructField('operation', StringType(), True)]), True), True), StructField('dynamicProcesses', ArrayType(StructType([StructField('fromCustomer', ArrayType(StringType(), True), True), StructField('processName', StringType(), True), StructField('toCustomer', ArrayType(StringType(), True), True)]), True), True), StructField('process', StringType(), True), StructField('timestamp', StringType(), True)]), True), StructField('customer', StructType([StructField('profile', StructType([StructField('contact', StructType([StructField('addresses', ArrayType(StructType([StructField('cityName', StringType(), True), StructField('countryCode', StringType(), True), StructField('countryName', StringType(), True), StructField('lines', ArrayType(StringType(), True), True), StructField('postalBox', StringType(), True), StructField('postalCode', StringType(), True), StructField('rank', LongType(), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True), StructField('stateCode', StringType(), True), StructField('stateName', StringType(), True), StructField('text', StringType(), True)]), True), True), StructField('emails', ArrayType(StructType([StructField('address', StringType(), True), StructField('rank', LongType(), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True)]), True), True), StructField('phones', ArrayType(StructType([StructField('areaCode', StringType(), True), StructField('countryCode', StringType(), True), StructField('deviceType', StringType(), True), StructField('extension', StringType(), True), StructField('isFormatted', BooleanType(), True), StructField('number', StringType(), True), StructField('rank', LongType(), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True), StructField('text', StringType(), True)]), True), True)]), True), StructField('id', StringType(), True), StructField('identity', StructType([StructField('demographics', ArrayType(StructType([StructField('birthCountry', StringType(), True), StructField('birthDate', StringType(), True), StructField('birthPlace', StringType(), True), StructField('civilStatus', StringType(), True), StructField('gender', StringType(), True), StructField('nationalities', ArrayType(StringType(), True), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True)]), True), True), StructField('documents', ArrayType(StructType([StructField('birthCountry', StringType(), True), StructField('birthDate', StringType(), True), StructField('birthPlace', StringType(), True), StructField('civilStatus', StringType(), True), StructField('documentType', StringType(), True), StructField('effectiveDate', StringType(), True), StructField('expiryDate', StringType(), True), StructField('gender', StringType(), True), StructField('issuanceCountry', StringType(), True), StructField('issuanceDate', StringType(), True), StructField('issuanceLocation', StringType(), True), StructField('label', StringType(), True), StructField('nationality', StringType(), True), StructField('number', StringType(), True), StructField('rank', LongType(), True), StructField('remarks', ArrayType(StringType(), True), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True)]), True), True), StructField('names', ArrayType(StructType([StructField('universal', StructType([StructField('firstName', StringType(), True), StructField('lastName', StringType(), True), StructField('middleNames', ArrayType(StringType(), True), True), StructField('prefix', StringType(), True), StructField('rank', LongType(), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True), StructField('titles', ArrayType(StringType(), True), True)]), True)]), True), True)]), True), StructField('links', ArrayType(StructType([StructField('cemId', StringType(), True), StructField('link', StructType([StructField('pnr', StructType([StructField('booking', StructType([StructField('locator', StructType([StructField('external', StructType([StructField('value', StringType(), True)]), True), StructField('internal', StructType([StructField('value', StringType(), True)]), True)]), True), StructField('numberInParty', LongType(), True), StructField('tourOperatorCode', StringType(), True)]), True), StructField('id', StringType(), True), StructField('passengerTattoo', LongType(), True), StructField('sourceType', StringType(), True)]), True), StructField('sourceType', StringType(), True), StructField('ticketing', StructType([StructField('envelope', LongType(), True), StructField('id', StringType(), True), StructField('sourceType', StringType(), True), StructField('ticket', StructType([StructField('issuedAt', StringType(), True), StructField('number', StringType(), True), StructField('owner', StringType(), True)]), True)]), True), StructField('version', LongType(), True)]), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True)]), True), True), StructField('memberships', ArrayType(StructType([StructField('activeTier', StructType([StructField('code', StringType(), True), StructField('milesBalances', ArrayType(StructType([StructField('balanceType', StringType(), True), StructField('expiryDate', StringType(), True), StructField('name', StringType(), True), StructField('value', StringType(), True)]), True), True), StructField('name', StringType(), True), StructField('priorityCode', StringType(), True)]), True), StructField('allianceTier', StructType([StructField('code', StringType(), True), StructField('milesBalances', ArrayType(StructType([StructField('balanceType', StringType(), True), StructField('expiryDate', StringType(), True), StructField('name', StringType(), True), StructField('value', StringType(), True)]), True), True), StructField('name', StringType(), True), StructField('priorityCode', StringType(), True)]), True), StructField('memberId', StringType(), True), StructField('membershipType', StringType(), True), StructField('program', StructType([StructField('owner', StringType(), True)]), True), StructField('rank', LongType(), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True)]), True), True), StructField('metrics', ArrayType(StructType([StructField('additionalDetails', StructType([StructField('computedFrom', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True)]), True), StructField('code', StringType(), True), StructField('name', StringType(), True), StructField('sources', ArrayType(StructType([StructField('id', StringType(), True), StructField('sourceType', StringType(), True)]), True), True), StructField('value', StringType(), True)]), True), True), StructField('version', StringType(), True)]), True)]), True), StructField('dictionary', StructType([StructField('pnrSources', ArrayType(StructType([StructField('booking', StructType([StructField('createdAt', StringType(), True), StructField('lastModifiedAt', StringType(), True), StructField('locator', StructType([StructField('external', StructType([StructField('value', StringType(), True)]), True), StructField('internal', StructType([StructField('value', StringType(), True)]), True)]), True), StructField('numberInParty', LongType(), True)]), True), StructField('envelop', LongType(), True), StructField('id', StringType(), True), StructField('passengerTattoo', LongType(), True), StructField('sourceType', StringType(), True)]), True), True), StructField('ticketingSources', ArrayType(StructType([StructField('envelop', LongType(), True), StructField('id', StringType(), True), StructField('lastModifiedAt', StringType(), True), StructField('link', StringType(), True), StructField('receivedAt', StringType(), True), StructField('sourceType', StringType(), True), StructField('status', StringType(), True), StructField('ticket', StructType([StructField('issuedAt', StringType(), True), StructField('number', StringType(), True), StructField('owner', StringType(), True)]), True), StructField('version', LongType(), True)]), True), True)]), True)]), True)])